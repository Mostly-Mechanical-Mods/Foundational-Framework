FF_elector_self_voting_pattern_feudal_elective_modifier = {
	##########################	Elector voting himself	##########################
	if = {
		limit = { this = scope:supporter }
		if = {
			limit = {
				OR = {
					has_trait = humble
					has_trait = content
					has_trait = craven
					has_trait = lazy
					has_trait = depressed
				}
			}
			if = {
				limit = { NOT = { has_trait = ambitious }}
				add = {
					value = -25
					desc = BMU_tooltip_feudal_elector_vote_not_myself
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		else = {
			if = {
				limit = { has_trait = ambitious }
				if = {
					limit = { is_adult = yes }
					add = {
						value = {
							add = 40
							add = {
								add = ai_boldness
								min = 0
							}
							add = {
								add = ai_greed
								min = 0
							}
						}
						desc = BMU_tooltip_feudal_elector_vote_myself_ambitious
						format = "FF_VALUE_FORMAT"
					}
				}
			}
			else = {
				if = {
					limit = { scope:claim_target = { is_parent_of = prev }}
					add = {
						value = {
							add = 40
							add = {
								add = ai_boldness
								min = 0
							}
							add = {
								add = ai_greed
								min = 0
							}
						}
						desc = BMU_tooltip_feudal_elector_vote_myself_heir
						format = "FF_VALUE_FORMAT"
					}
				}
				else = {
					add = {
						value = 15
						desc = BMU_tooltip_feudal_elector_vote_myself
					}
				}
			}
		}
		if = {
			limit = {
				is_adult = yes
				exists = dynasty
				dynasty = scope:claim_target.dynasty
			}
			add = {
				value = {
					value = 40
					if = {
						limit = {
							scope:s_contender.dynasty = { dynasty_prestige_level >= 10 }
						}
						add = 20
					}
					if = {
						limit = {
							scope:s_contender.dynasty = { dynasty_prestige_level >= 7 }
						}
						add = 20
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_myself_ruling_dynasty
			}
		}
		if = {
			limit = {
				is_healthy = no
				is_adult = yes
			}
			add = {
				value = {
					subtract = 20
					if = {
						limit = { has_trait = pneumonic }
						subtract = 10
					}
					if = {
						limit = { has_trait = leper }
						subtract = 50
					}
					if = {
						limit = { has_trait = bubonic_plague }
						subtract = 50
					}
					if = {
						limit = { has_trait = wounded_3 }
						subtract = 25
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_myself_sick
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = { has_claim_on = scope:claimed_title }
			add = {
				value = {
					if = {
						limit = { has_strong_claim_on = scope:claimed_title }
						add = 30
					}
					if = {
						limit = { has_weak_claim_on = scope:claimed_title }
						add = 30
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_myself_claimant
				format = "FF_VALUE_FORMAT"
			}
		}
	}
}

FF_elector_voting_pattern_circumstances_feudal_elective_modifier = {
	#Sexism
	if = {
		limit = {
			OR = {
				#Title might have different law than realm's.
				scope:claimed_title = { has_title_law = male_preference_law }
				#If title has neither the required law nor its opposites, check for realm law.
				AND = {
					trigger_if = {
						limit = { exists = scope:claim_target }
						scope:claim_target = { has_realm_law = male_preference_law }
					}
					scope:claimed_title = {
						NOR = {
							has_title_law = female_preference_law
							has_title_law = equal_law
						}
					}
				}
				scope:supporter.faith = { has_doctrine = doctrine_gender_male_dominated }
			}
			scope:s_contender = { is_female = yes }
		}
		add = {
			value = {
				subtract = 100
				if = { #Increase if both.
					limit = {
						OR = {
							#Title might have different law than realm's.
							scope:claimed_title = { has_title_law = male_preference_law }
							#If title has neither the required law nor its opposites, check for realm law.
							AND = {
								scope:claim_target = { has_realm_law = male_preference_law }
								scope:claimed_title = {
									NOR = {
										has_title_law = female_preference_law
										has_title_law = equal_law
									}
								}
							}
						}
						scope:supporter.faith = { has_doctrine = doctrine_gender_male_dominated }
					}
					multiply = 1.5
				}
				if = { #Halve if talking about myself.
					limit = { this = scope:supporter }
					multiply = 0.5
				}
			}
			desc = BMU_tooltip_feudal_elector_vote_agnatic_woman
			format = "FF_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			OR = {
				#Title might have different law than realm's.
				scope:claimed_title = { has_title_law = female_preference_law }
				#If title has neither the required law nor its opposites, check for realm law.
				AND = {
					scope:claim_target = { has_realm_law = female_preference_law }
					scope:claimed_title = {
						NOR = {
							has_title_law = male_preference_law
							has_title_law = equal_law
						}
					}
				}
				faith = { has_doctrine = doctrine_gender_female_dominated }
			}
			scope:s_contender = { is_female = no }
		}
		add = {
			value = {
				subtract = 100
				if = { #Increase if both.
					limit = {
						OR = {
							#Title might have different law than realm's.
							scope:claimed_title = { has_title_law = female_preference_law }
							#If title has neither the required law nor its opposites, check for realm law.
							AND = {
								scope:claim_target = { has_realm_law = female_preference_law }
								scope:claimed_title = {
									NOR = {
										has_title_law = male_preference_law
										has_title_law = equal_law
									}
								}
							}
						}
						scope:supporter.faith = { has_doctrine = doctrine_gender_female_dominated }
					}
					multiply = 1.5
				}
				if = { #Halve if talking about myself.
					limit = { this = scope:supporter }
					multiply = 0.5
				}
			}
			desc = BMU_tooltip_feudal_elector_vote_enatic_man
			format = "FF_VALUE_FORMAT"
		}
	}
	if = {
		limit = { NOT = { this = scope:supporter }}
		#Ageism
		if = {
			limit = { scope:s_contender.age < 5 }
			add = {
				value = -30
				desc = BMU_tooltip_feudal_elector_vote_baby
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = { scope:s_contender.age < 10 }
			add = {
				value = -25
				desc = BMU_tooltip_feudal_elector_vote_child
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = { scope:s_contender.age < 16 }
			add = {
				value = -10
				desc = BMU_tooltip_feudal_elector_vote_child
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = { #Still too young for older rulers
			limit = {
				scope:s_contender.age < 25
				age > 40
			}
			add = {
				value = -10
				desc = BMU_tooltip_feudal_elector_vote_youngster
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = { #Or simply too old overall.
			limit = { scope:s_contender.age > 50 }
			add = {
				value = -15
				desc = BMU_tooltip_feudal_elector_vote_decrepit
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = { #Or too old for younger rulers.
			limit = {
				scope:s_contender.age > 40
				age > 30
			}
			add = {
				value = -10
				desc = BMU_tooltip_feudal_elector_vote_oldtimer
				format = "FF_VALUE_FORMAT"
			}
		}
		#Culturism
		if = {
			limit = { culture = scope:s_contender.culture }
			add = {
				value = 10
				desc = BMU_tooltip_feudal_elector_vote_fellow_culture
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = { NOT = { scope:supporter = { is_close_family_of = scope:s_contender }}}
			if = {
				limit = { scope:supporter.culture = { has_same_culture_heritage = scope:s_contender.culture }}
				add = {
					value = -15
					desc = BMU_tooltip_feudal_elector_vote_stranger
					format = "FF_VALUE_FORMAT"
				}
			}
			else = {
				add = {
					value = -30
					desc = BMU_tooltip_feudal_elector_vote_foreigner
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		#Faithism
		if = {
			limit = { NOT = { scope:supporter.faith = scope:s_contender.faith }}
			if = {
				limit = {
					scope:supporter.faith = {
						faith_hostility_level = {
							target = scope:s_contender.faith
							value = faith_fully_accepted_level
						}
					}
					ai_zeal >= 0
				}
				add = {
					value = -25
					desc = BMU_tooltip_feudal_elector_vote_different_faith
					format = "FF_VALUE_FORMAT"
				}
			}
			else_if = {
				limit = {
					scope:supporter.faith = {
						faith_hostility_level = {
							target = scope:s_contender.faith
							value = faith_astray_level
						}
					}
				}
				add = {
					value = -50
					desc = BMU_tooltip_feudal_elector_vote_astray
					format = "FF_VALUE_FORMAT"
				}
			}
			else_if = {
				limit = {
					scope:supporter.faith = {
						faith_hostility_level = {
							target = scope:s_contender.faith
							value = faith_hostile_level
						}
					}
				}
				add = {
					value = {
						if = { limit = { scope:supporter.ai_zeal >= high_positive_zeal } subtract = 250 }
						else_if = { limit = { scope:supporter.ai_zeal >= medium_positive_zeal }  subtract = 200 }
						else_if = { limit = { scope:supporter.ai_zeal >= low_positive_zeal } subtract = 150 }
						else = { subtract = 100 }
					}
					desc = BMU_tooltip_feudal_elector_vote_heretic
					format = "FF_VALUE_FORMAT"
				}
			}
			else_if = {
				limit = {
					scope:supporter.faith = {
						faith_hostility_level = {
							target = scope:s_contender.faith
							value = faith_hostile_level
						}
					}
				}
				add = {
					value = {
						if = { limit = { scope:supporter.ai_zeal >= high_positive_zeal } subtract = 425 }
						else_if = { limit = { scope:supporter.ai_zeal >= medium_positive_zeal }  subtract = 350 }
						else_if = { limit = { scope:supporter.ai_zeal >= low_positive_zeal } subtract = 275 }
						else = { subtract = 200 }
					}
				}
			}
		}
		#Barbarism
		if = {
			limit = {
				scope:supporter = {
					OR = {
						has_government = feudal_government
						has_government = republic_government
					}
				}
				scope:s_contender = {
					OR = {
						has_government = clan_government
						has_government = tribal_government
					}
				}
			}
			add = {
				value = -15
				desc = BMU_tooltip_feudal_elector_vote_uncivilized
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = {
				scope:supporter = { has_government = clan_government }
				scope:s_contender = { NOT = { has_government = clan_government }}
			}
			add = {
				value = -15
				desc = BMU_tooltip_feudal_elector_vote_settled
				format = "FF_VALUE_FORMAT"
			}
		}
		#Nepotism
		if = {
			limit = { scope:s_contender = { is_child_of = prev }}
			add = {
				value = 30
				desc = BMU_tooltip_feudal_elector_vote_parent
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = { scope:s_contender = { is_close_family_of = prev }}
			add = {
				value = 20
				desc = BMU_tooltip_feudal_elector_vote_relative
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = {
				exists = scope:supporter.dynasty
				exists = scope:s_contender.dynasty
				dynasty = scope:s_contender.dynasty
			}
			add = {
				value = 10
				desc = BMU_tooltip_feudal_elector_vote_dynasty
				format = "FF_VALUE_FORMAT"
			}
		}
		#Educational preferences
		if = {
			limit = {
				scope:supporter = { this_is_martial_society_trigger = yes }
				scope:s_contender = {
					martial >= 10
					OR = {
						has_trait = education_martial
						has_lifestyle = martial_lifestyle
						has_trait = lifestyle_blademaster
						has_martial_lifestyle_trait_trigger = yes
					}
				}
			}
			add = {
				value = 15
				desc = BMU_tooltip_feudal_elector_vote_martial_education
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = {
				scope:supporter = { this_is_diplomatic_society_trigger = yes }
				scope:s_contender = {
					OR = {
						AND = {
							diplomacy >= 10
							OR = {
								has_trait = education_diplomacy
								has_lifestyle = diplomacy_lifestyle
								has_diplomacy_lifestyle_trait_trigger = yes
								has_trait = lifestyle_reveler
								has_trait = gallant
							}
						}
						AND = {
							stewardship >= 10
							OR = {
								has_trait = education_stewardship
								has_lifestyle = stewardship_lifestyle
								has_stewardship_lifestyle_trait_trigger = yes
							}
						}
					}
				}
			}
			add = {
				value = 15
				desc = BMU_tooltip_feudal_elector_vote_diplomatic_education
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = {
				scope:supporter = { this_is_spiritual_society_trigger = yes }
				scope:s_contender = {
					learning >= 10
					OR = {
						has_trait = education_learning
						has_lifestyle = learning_lifestyle
						has_learning_lifestyle_trait_trigger = yes
						has_trait = lifestyle_mystic
						has_trait = lifestyle_physician
					}
				}
			}
			add = {
				value = 15
				desc = BMU_tooltip_feudal_elector_vote_spiritual_education
				format = "FF_VALUE_FORMAT"
			}
		}
		#Claims
		if = {
			limit = { scope:s_contender = { has_strong_claim_on = scope:claimed_title }}
			add = {
				value = 30
				desc = BMU_tooltip_feudal_elector_vote_strong_claimant
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = { scope:s_contender = { has_weak_claim_on = scope:claimed_title }}
			add = {
				value = 15
				desc = BMU_tooltip_feudal_elector_vote_weak_claimant
				format = "FF_VALUE_FORMAT"
			}
		}
	}
	if = {
		limit = {
			scope:supporter = {
				is_landed = yes
				exists = capital_county
				capital_county = { scope:claimed_title = { is_de_jure_liege_or_above_target = prev }}
				OR = {
					scope:claim_target.capital_county = { scope:claimed_title = { NOT = { is_de_jure_liege_or_above_target = prev }}}
					scope:s_contender = { highest_held_title_tier > scope:claimed_title.tier }
				}
			}
			scope:s_contender = {
				is_ruler = yes
				is_vassal_of = scope:claim_target
				exists = capital_county
				NOT = { capital_county = { scope:claimed_title = { is_de_jure_liege_or_above_target = prev }}}
			}
		}
		add = {
			value = -15
			desc = BMU_tooltip_feudal_elector_vote_political_concerns
			format = "FF_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			scope:supporter = {
				is_landed = yes
				exists = capital_county
				target_is_liege_or_above = scope:claim_target
			}
			scope:s_contender = {
				is_ruler = yes
				NOT = { target_is_liege_or_above = scope:claim_target }
			}
		}
		add = {
			value = {
				subtract = 30
				if = {
					limit = { NOT = { scope:supporter.capital_county = { scope:claimed_title = { is_de_jure_liege_or_above_target = prev }}}}
					subtract = 470
				}
			}
			desc = BMU_tooltip_feudal_elector_vote_encroaching_foreigner
			format = "FF_VALUE_FORMAT"
		}
	}
}

FF_elector_voting_pattern_prestige_piety_feudal_elective_modifier = {
	#Prestige
	if = {
		limit = { NOT = { this = scope:supporter }}
		if = {
			limit = { scope:s_contender = { prestige_level < 1 }}
			add = {
				value = -10
				desc = BMU_tooltip_feudal_elector_vote_prestige_negative
				format = "FF_VALUE_FORMAT"
			}
		}
		else = {
			add = {
				value = {
					add = scope:s_contender.prestige_level
					subtract = 1
					multiply = 5
				}
				desc = BMU_tooltip_feudal_elector_vote_prestige_positive
				format = "FF_VALUE_FORMAT"
			}
		}
		#Dynasty Prestige
		add = {
			value = {
				if = {
					limit = { scope:s_contender.dynasty = { dynasty_prestige_level >= 10 }}
					add = 60
				}
				else_if = {
					limit = { scope:s_contender.dynasty = { dynasty_prestige_level >= 7 }}
					add = 40
				}
				else_if = {
					limit = { scope:s_contender.dynasty = { dynasty_prestige_level >= 4 }}
					add = 20
				}
			}
			desc = BMU_tooltip_feudal_elector_vote_dynasty_prestige
			format = "FF_VALUE_FORMAT"
		}
		#Piety
		if = {
			limit = { scope:supporter.ai_zeal > 0 }
			if = {
				limit = { scope:s_contender = { piety_level < 1}}
				add = {
					value = -10
					desc = BMU_tooltip_feudal_elector_vote_piety_negative
					format = "FF_VALUE_FORMAT"
				}
			}
			else = {
				add = {
					value = {
						add = scope:s_contender.piety_level
						subtract = 1
						multiply = 5
					}
					desc = BMU_tooltip_feudal_elector_vote_piety_positive
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		#Trait compatibility between elector and contender
		if = {
			limit = {
				scope:supporter = {
					ai_zeal > 0
					NOT = { has_trait = cynical }
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = num_sinful_traits
						multiply = 5
						multiply = ai_zeal
						multiply = 0.1
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_sinful
				format = "FF_VALUE_FORMAT"
			}
			add = {
				value = {
					scope:supporter = {
						add = num_virtuous_traits
						multiply = 5
						multiply = ai_zeal
						multiply = 0.05
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_virtuous
				format = "FF_VALUE_FORMAT"
			}
		}
		#Excommunication
		if = {
			limit = {
				scope:supporter = {
					faith = { has_doctrine_parameter = excommunication_active }
					faith = scope:s_contender.faith
					OR = {
						NOT = { has_trait = excommunicated }
						has_trait = arbitrary #No need for consistency
					}
				}
				scope:s_contender = { has_trait = excommunicated }
			}
			add = {
				value = {
					subtract = 25
					if = {
						limit = { scope:supporter.ai_zeal > 0 }
						subtract = {
							value = scope:supporter.ai_zeal
							multiply = 0.5
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_excommunication
				format = "FF_VALUE_FORMAT"
			}
		}
		#Illegitimate children (excepting the children of consorts, which filter separately)
		if = {
			limit = {
				scope:supporter = {
					NOT = { faith = { has_doctrine = doctrine_bastardry_none }}
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOR = {
							has_trait = bastard
							has_trait = legitimized_bastard
							has_trait = wild_oat
						}
					}
				}
				scope:s_contender = {
					OR = {
						has_trait = bastard
						has_trait = legitimized_bastard
						has_trait = wild_oat
					}
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = { limit = { faith = { has_doctrine = doctrine_bastardry_legitimization }} subtract = 10 }
						else_if = { limit = { faith = { has_doctrine = doctrine_bastardry_all }} subtract = 15 }
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_out_of_wedlock
				format = "FF_VALUE_FORMAT"
			}
		}
		#Children of Consorts
		if = {
			limit = {
				scope:supporter = {
					NOR = {
						allowed_concubines = yes
						faith = { has_doctrine = doctrine_bastardry_none }
					}
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = child_of_concubine }
					}
					scope:s_contender = { has_trait = child_of_concubine }
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = { limit = { faith = { has_doctrine = doctrine_bastardry_legitimization }} subtract = 10 }
						else_if = { limit = { faith = { has_doctrine = doctrine_bastardry_all }} subtract = 15 }
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_out_of_wedlock
				format = "FF_VALUE_FORMAT"
			}
		}
		#Sodomy Crime
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine =  doctrine_homosexuality_accepted }}
					ai_zeal > 0
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = sodomite }
					}
				}
				scope:s_contender = { has_trait = sodomite }
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = { limit = { faith = { has_doctrine = doctrine_homosexuality_shunned }} subtract = 10 }
						else_if = { limit = { faith = { has_doctrine = doctrine_homosexuality_crime }} subtract = 15 }
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_out_of_wedlock
				format = "FF_VALUE_FORMAT"
			}
		}
		#Kinslayer Crime
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine = doctrine_kinslaying_accepted }}
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = kinslayer }
					}
				}
				scope:s_contender = { has_trait = kinslayer }
			}
			add = {
				value = {
					scope:supporter = {

						if = {
							limit = { scope:s_contender = { has_trait = kinslayer_1 }}
							subtract = 10
							if = {
								limit = { faith = { has_doctrine = doctrine_kinslaying_any_dynasty_member_crime }}
								multiply = 2
							}
						}
						else_if = {
							limit = { scope:s_contender = { has_trait = kinslayer_2 }}
							subtract = 15
							if = {
								limit = {
									faith = {
										OR = {
											has_doctrine = doctrine_kinslaying_any_dynasty_member_crime
											has_doctrine = doctrine_kinslaying_extended_family_crime
										}
									}
								}
								multiply = 2
							}
						}
						else_if = {
							limit = { scope:s_contender = { has_trait = kinslayer_3 }}
							subtract = 20
							if = {
								limit = {
									faith = {
										OR = {
											has_doctrine = doctrine_kinslaying_any_dynasty_member_crime
											has_doctrine = doctrine_kinslaying_extended_family_crime
											has_doctrine = doctrine_kinslaying_close_kin_crime
										}
									}
								}
								multiply = 2
							}
						}
						if = {
							limit = {
								exists = dynasty
								exists = scope:s_contender.dynasty
								NOT = { dynasty = scope:s_contender.dynasty }
							}
							subtract = 10
						}
						else_if = {
							limit = {
								exists = scope:s_contender.dynasty
								dynasty = scope:s_contender.dynasty
								NOT = { is_close_family_of = scope:s_contender }
							}
							subtract = 20
						}
						else_if = {
							limit = {
								exists = scope:s_contender.dynasty
								dynasty = scope:s_contender.dynasty
								is_close_family_of = scope:s_contender
							}
							subtract = 30
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_kinslayer
				format = "FF_VALUE_FORMAT"
			}
		}
		#Deviancy
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine = doctrine_deviancy_accepted }}
					ai_zeal > 0
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = deviant }
					}
					scope:s_contender = { has_trait = sodomite }
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = { limit = { faith = { has_doctrine = doctrine_deviancy_shunned }} subtract = 10 }
						else_if = { limit = { faith = { has_doctrine = doctrine_deviancy_crime }} subtract = 15 }
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_deviant
				format = "FF_VALUE_FORMAT"
			}
		}
		#Cannibalism
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine_parameter = cannibalism_legal }}
					ai_zeal > 0
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = cannibal }
					}
					scope:s_contender = { has_trait = cannibal }
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 30
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_cannibal
				format = "FF_VALUE_FORMAT"
			}
		}
		#Incest
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine = doctrine_consanguinity_unrestricted }}
					ai_zeal > 0
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = incestuous }
					}
				}
				scope:s_contender = { has_trait = incestuous }
			}
			add = {
				value = {
					subtract = 25
					if = {
						limit = { ai_zeal > 10 }
						subtract = {
							value = ai_zeal
							multiply = 0.5
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_incestuous
				format = "FF_VALUE_FORMAT"
			}
		}
		#Adultery - males
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine = doctrine_adultery_men_accepted }}
					ai_zeal > 0
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = adulterer }
					}
				}
				scope:s_contender = {
					has_trait = adulterer
					is_female = no
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = { limit = { faith = { has_doctrine = doctrine_adultery_men_shunned }} subtract = 10 }
						else_if = { limit = { faith = { has_doctrine = doctrine_adultery_men_crime }} subtract = 15 }
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_adulterous_man
				format = "FF_VALUE_FORMAT"
			}
		}
		#Adultery - females
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine = doctrine_adultery_women_accepted }}
					ai_zeal > 0
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = adulterer }
					}
				}
				scope:s_contender = {
					has_trait = adulterer
					is_female = yes
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = { limit = { faith = { has_doctrine = doctrine_adultery_women_shunned }} subtract = 10 }
						else_if = { limit = { faith = { has_doctrine = doctrine_adultery_women_crime }} subtract = 15 }
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_adulterous_man
				format = "FF_VALUE_FORMAT"
			}
		}
		#Fornication - males
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine = doctrine_adultery_men_accepted }}
					ai_zeal > 0
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = fornicator }
					}
				}
				scope:s_contender = {
					has_trait = fornicator
					is_female = no
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = { limit = { faith = { has_doctrine = doctrine_adultery_men_shunned }} subtract = 10 }
						else_if = { limit = { faith = { has_doctrine = doctrine_adultery_men_crime }} subtract = 15 }
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_fornicating_man
				format = "FF_VALUE_FORMAT"
			}
		}
		#Fornication - females
		if = {
			limit = {
				scope:supporter = {
					faith = { NOT = { has_doctrine = doctrine_adultery_women_accepted }}
					ai_zeal > 0
					trigger_if = {
						limit = { NOT = { has_trait = arbitrary }}
						NOT = { has_trait = fornicator }
					}
				}
				scope:s_contender = {
					has_trait = fornicator
					is_female = no
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = { limit = { faith = { has_doctrine = doctrine_adultery_women_shunned }} subtract = 10 }
						else_if = { limit = { faith = { has_doctrine = doctrine_adultery_women_crime }} subtract = 15 }
						if = {
							limit = { ai_zeal > 10 }
							subtract = {
								value = ai_zeal
								multiply = 0.5
							}
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_fornicating_man
				format = "FF_VALUE_FORMAT"
			}
		}
		#Attraction
		if = {
			limit = {
				scope:supporter = { is_adult = yes }
				scope:s_contender = { is_adult = yes }
			}
			if = {
				limit = { scope:s_contender = { attraction >= 25 }}
				add = {
					value = {
						value = 1
						multiply = scope:s_contender.attraction
						multiply = 0.1
					}
					desc = BMU_tooltip_feudal_elector_vote_attractive
					format = "FF_VALUE_FORMAT"
				}
			}
			else_if = {
				limit = { scope:s_contender = { attraction <= -25 }}
				add = {
					value = {
						value = -1
						multiply = scope:s_contender.attraction
						multiply = 0.1
					}
					desc = BMU_tooltip_feudal_elector_vote_ugly
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		#Special cases (ex. deformities, disfigured for Byzantines)
		if = {
			limit = { scope:s_contender = { has_trait = incapable }}
			if = {
				limit = { scope:supporter = { this_is_martial_society_trigger = no }}
				value = -35
				desc = BMU_tooltip_feudal_elector_vote_incapable
				format = "FF_VALUE_FORMAT"
			}
			else = {
				value = -50
				desc = BMU_tooltip_feudal_elector_vote_incapable_warrior
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = infirm }}
			if = {
				limit = { scope:supporter = { this_is_diplomatic_society_trigger = no }}
				value = -35
				desc = BMU_tooltip_feudal_elector_vote_infirm
				format = "FF_VALUE_FORMAT"
			}
			else = {
				value = -50
				desc = BMU_tooltip_feudal_elector_vote_infirm_diplomat
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = disfigured }}
			if = {
				limit = {
					scope:supporter = {
						this_is_diplomatic_society_trigger = no
						NOT = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
					}
				}
				value = -15
				desc = BMU_tooltip_feudal_elector_vote_disfigured
				format = "FF_VALUE_FORMAT"
			}
			else_if = {
				limit = { scope:supporter = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}}
				value = -100
				desc = BMU_tooltip_feudal_elector_vote_disfigured_byzantine
				format = "FF_VALUE_FORMAT"
			}
			else = {
				value = {
					scope:supporter = {
						subtract = 5
						if = {
							limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
							subtract = 45
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_disfigured_warrior
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = maimed }}
			if = {
				limit = { scope:supporter = { this_is_diplomatic_society_trigger = no }}
				value = -10
				desc = BMU_tooltip_feudal_elector_vote_infirm
				format = "FF_VALUE_FORMAT"
			}
			else = {
				value = -15
				desc = BMU_tooltip_feudal_elector_vote_infirm_diplomat
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = {
				scope:supporter = { culture = { has_cultural_parameter = children_can_be_born_in_the_purple }}
				scope:s_contender = { has_trait = born_in_the_purple }
			}
			add = {
				value = 50
				desc = BMU_tooltip_feudal_elector_vote_born_in_the_purple
				format = "FF_VALUE_FORMAT"
			}
		}
		# if = {
		# 	limit = {
		# 		scope:s_contender = {
		# 			OR = {
		# 				has_trait = intellect_good
		# 				has_trait = shrewd
		# 			}
		# 		}
		# 	}
		# 	if = {
		# 		limit = {
		# 			OR = {
		# 				this_is_diplomatic_society_trigger = yes
		# 				this_is_spiritual_society_trigger = yes
		# 			}
		# 		}
		# 		add = {
		# 			value = {
		# 				value = 10
		# 				if = { limit = { scope:s_contender = { has_trait = intellect_good_1 }} add = 5 }
		# 				else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 10 }
		# 				else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 15 }
		# 				if = { limit = { scope:s_contender = { has_trait = shrewd }} add = 10 }
		# 			}
		# 			desc = BMU_tooltip_feudal_elector_vote_genius_diplomat
		# 			format = "FF_VALUE_FORMAT"
		# 		}
		# 	}
		# 	else = {
		# 		add = {
		# 			value = {
		# 				value = 0
		# 				if = { limit = { scope:s_contender = { has_trait = intellect_good_1 }} add = 5 }
		# 				else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 10 }
		# 				else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 15 }
		# 				if = { limit = { scope:s_contender = { has_trait = shrewd }} add = 10 }
		# 			}
		# 			desc = BMU_tooltip_feudal_elector_vote_genius
		# 			format = "FF_VALUE_FORMAT"
		# 		}
		# 	}
		# }
		if = {
			limit = {
				scope:s_contender = {
					OR = {
						has_trait = intellect_good
						has_trait = shrewd
					}
				}
			}
			if = {
				limit = {
					scope:supporter = {
						OR = {
							this_is_diplomatic_society_trigger = yes
							this_is_spiritual_society_trigger = yes
						}
					}
				}
				add = {
					value = {
						value = 10
						if = { limit = { scope:s_contender = { has_trait = intellect_good_1 }} add = 5 }
						else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 10 }
						else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 15 }
						if = { limit = { scope:s_contender = { has_trait = shrewd }} add = 10 }
					}
					desc = BMU_tooltip_feudal_elector_vote_genius_diplomat
					format = "FF_VALUE_FORMAT"
				}
			}
			else = {
				add = {
					value = {
						value = 0
						if = { limit = { scope:s_contender = { has_trait = intellect_good_1 }} add = 5 }
						else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 10 }
						else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 15 }
						if = { limit = { scope:s_contender = { has_trait = shrewd }} add = 10 }
					}
					desc = BMU_tooltip_feudal_elector_vote_genius
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		else = {
			limit = {
				scope:s_contender = {
					OR = {
						has_trait = intellect_bad
						has_trait = dull
					}
				}
			}
			if = {
				limit = {
					scope:supporter = {
						OR = {
							this_is_diplomatic_society_trigger = yes
							this_is_spiritual_society_trigger = yes
						}
					}
				}
				add = {
					value = {
						value = 10
						if = { limit = { scope:s_contender = { has_trait = intellect_bad_1 }} subtract = 5 }
						else_if = { limit = { scope:s_contender = { has_trait = intellect_bad_2 }} subtract = 10 }
						else_if = { limit = { scope:s_contender = { has_trait = intellect_bad_3 }} subtract = 15 }
						if = { limit = { scope:s_contender = { has_trait = dull }} subtract = 10 }
					}
					desc = BMU_tooltip_feudal_elector_vote_imbecile_diplomat
					format = "FF_VALUE_FORMAT"
				}
			}
			else = {
				add = {
					value = {
						value = 0
						if = { limit = { scope:s_contender = { has_trait = intellect_good_1 }} add = 5 }
						else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 10 }
						else_if = { limit = { scope:s_contender = { has_trait = intellect_good_2 }} add = 15 }
						if = { limit = { scope:s_contender = { has_trait = shrewd }} add = 10 }
					}
					desc = BMU_tooltip_feudal_elector_vote_imbecile
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		if = {
			limit = {
				scope:s_contender = {
					OR = {
						has_trait = physique_good
						has_trait = strong
					}
				}
			}
			if = {
				limit = { scope:supporter = { this_is_martial_society_trigger = yes }}
				add = {
					value = {
						value = 10
						if = { limit = { scope:s_contender = { has_trait = physique_good_1 }} add = 5 }
						else_if = { limit = { scope:s_contender = { has_trait = physique_good_2 }} add = 10 }
						else_if = { limit = { scope:s_contender = { has_trait = physique_good_3 }} add = 15 }
						if = { limit = { scope:s_contender = { has_trait = strong }} add = 10 }
					}
					desc = BMU_tooltip_feudal_elector_vote_strong_warrior
					format = "FF_VALUE_FORMAT"
				}
			}
			else = {
				add = {
					value = {
						value = 0
						if = { limit = { scope:s_contender = { has_trait = physique_good_1 }} add = 5 }
						else_if = { limit = { scope:s_contender = { has_trait = physique_good_2 }} add = 10 }
						else_if = { limit = { scope:s_contender = { has_trait = physique_good_3 }} add = 15 }
						if = { limit = { scope:s_contender = { has_trait = strong }} add = 10 }
					}
					desc = BMU_tooltip_feudal_elector_vote_strong
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = clubfooted }}
			add = {
				value = {
					scope:supporter = {
						subtract = 5
						if = {
							limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
							subtract = 10
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_clubfooted
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = dwarf }}
			if = {
				limit = { scope:supporter = { this_is_martial_society_trigger = no }}
				add = {
					value = {
						scope:supporter = {
							subtract = 15
							if = {
								limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
								subtract = 20
							}
						}
					}
					desc = BMU_tooltip_feudal_elector_vote_dwarf
					format = "FF_VALUE_FORMAT"
				}
			}
			else = {
				add = {
					value = {
						scope:supporter = {
							subtract = 30
							if = {
								limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
								subtract = 30
							}
						}
					}
					desc = BMU_tooltip_feudal_elector_vote_dwarf
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = hunchbacked }}
			if = {
				limit = { scope:supporter = { this_is_martial_society_trigger = no }}
				add = {
					value = {
						scope:supporter = {
							subtract = 15
							if = {
								limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
								subtract = 30
							}
						}
					}
					desc = BMU_tooltip_feudal_elector_vote_dwarf
					format = "FF_VALUE_FORMAT"
				}
			}
			else = {
				add = {
					value = {
						scope:supporter = {
							subtract = 30
							if = {
								limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
								subtract = 30
							}
						}
					}
					desc = BMU_tooltip_feudal_elector_vote_hunchback_warrior
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		if = {
			limit = {
				scope:s_contender = {
					OR = {
						has_trait = inbred
						has_trait = spindly
						has_trait = scaly
						has_trait = albino
						has_trait = wheezing
						has_trait = bleeder
					}
				}
			}
			add = {
				value = {
					scope:supporter = {
						subtract = 15
						if = {
							limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
							subtract = 60
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_inbred
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = lisping }}
			add = {
				value = {
					scope:supporter = {
						subtract = 5
						if = {
							limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }}
							subtract = 10
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_lisping
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = stuttering }}
			add = {
				value = -5
				desc = BMU_tooltip_feudal_elector_vote_stuttering
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = {
				scope:supporter = {
					OR = {
						has_trait = arbitrary #No need for consistency
						NOT = { has_personality_malicious_trigger = yes }
					}
				}
				scope:s_contender = { has_personality_malicious_trigger = yes }
			}
			add = {
				value = -25
				desc = BMU_tooltip_feudal_elector_vote_evil_negative
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = {
				scope:supporter = {
					OR = {
						has_trait = arbitrary #No need for consistency
						NOR = {
							has_trait = lunatic
							has_trait = possessed
						}
					}
				}
				scope:s_contender = {  has_trait = lunatic }
			}
			add = {
				value = -15
				desc = BMU_tooltip_feudal_elector_vote_lunatic_negative
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = {
				scope:supporter = {
					NOT = { faith = { has_doctrine_parameter = spirit_possession_active }}
					OR = {
						has_trait = arbitrary #No need for consistency
						NOR = {
							has_trait = lunatic
							has_trait = possessed
						}
					}
				}
				scope:s_contender = {  has_trait = possessed }
			}
			add = {
				value = -15
				desc = BMU_tooltip_feudal_elector_vote_possessed_negative
				format = "FF_VALUE_FORMAT"
			}
		}
		else_if = {
			limit = {
				scope:supporter = {
					faith = { has_doctrine_parameter = spirit_possession_active }
					ai_zeal > 10
				}
				scope:s_contender = { has_trait = possessed }
			}
			add = {
				value = 35
				desc = BMU_tooltip_feudal_elector_vote_possessed_positive
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = {
				scope:supporter = {
					faith = scope:s_contender.faith
					ai_zeal > 10
				}
			}
			if = {
				limit = { scope:s_contender = { has_trait = pilgrim }}
				add = {
					value = 10
					desc = BMU_tooltip_feudal_elector_vote_pilgrim_positive
					format = "FF_VALUE_FORMAT"
				}
			}
			if = {
				limit = { scope:s_contender = { has_trait = faith_warrior }}
				add = {
					value = 10
					desc = BMU_tooltip_feudal_elector_vote_crusader_positive
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		else_if = {
			limit = {
				scope:supporter = {
					NOR = { faith = scope:s_contender.faith }
					faith = {
						faith_hostility_level = {
							target = scope:s_contender.faith
							value >= faith_hostile_level
						}
					}
				}
			}
			add = {
				value = -15
				desc = BMU_tooltip_feudal_elector_vote_crusader_negative
				format = "FF_VALUE_FORMAT"
			}
		}
		#Praised for being a saoshyant_descendant
		if = {
			limit = {
				scope:supporter.faith = { religion_tag = zoroastrianism_religion }
				scope:s_contender = { has_trait = saoshyant_descendant }
			}
			add = {
				value = 10
				desc = BMU_tooltip_feudal_elector_vote_saoshyant_descendant_positive
				format = "FF_VALUE_FORMAT"
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = adventurer }}
			#Praised for being Adventurer
			if = {
				limit = { scope:supporter = { this_is_martial_society_trigger = yes }}
				add = {
					value = 10
					desc = BMU_tooltip_feudal_elector_vote_adventurer_positive
					format = "FF_VALUE_FORMAT"
				}
			}
			#Shunned for being Adventurer
			else = {
				add = {
					value = -10
					desc = BMU_tooltip_feudal_elector_vote_adventurer_negative
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = berserker }}
			#Praised for being Berserker
			if = {
				limit = { scope:supporter = { this_is_martial_society_trigger = yes }}
				add = {
					value = 5
					desc = BMU_tooltip_feudal_elector_vote_berserker_positive
					format = "FF_VALUE_FORMAT"
				}
			}
			#Shunned for being Berserker
			else = {
				add = {
					value = -20
					desc = BMU_tooltip_feudal_elector_vote_berserker_negative
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		#Shunned for being blind
		if = {
			limit = { scope:s_contender = { has_trait = blind }}
			if ={
				limit = { scope:supporter = { this_is_martial_society_trigger = no }}
				add = {
					value = {
						scope:supporter = {
							subtract = 10
							if = {
								limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance } }
								subtract = 140
							}
						}
					}
					desc = BMU_tooltip_feudal_elector_vote_blinded_negative
					format = "FF_VALUE_FORMAT"
				}
			}
			else = {
				add = {
					value = {
						scope:supporter = {
							subtract = 20
							if = {
								limit = { culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance } }
								subtract = 130
							}
						}
					}
					desc = BMU_tooltip_feudal_elector_vote_blinded_negative_warrior
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		#Shunned for being eunuch
		if = {
			limit = { scope:supporter = { has_trait = eunuch }}
			if = {
				limit = {
					scope:supporter = {
						NOR = {
							culture = { has_cultural_parameter = physical_disfigurement_blocks_inheritance }
							faith = { religion_tag = islam_religion }
						}
					}
				}
				if ={
					limit = { scope:supporter = { this_is_martial_society_trigger = no }}
					add = {
						value = -25
						desc = BMU_tooltip_feudal_elector_vote_eunuch_negative
						format = "FF_VALUE_FORMAT"
					}
				}
				else = {
					add = {
						value = -50
						desc = BMU_tooltip_feudal_elector_vote_eunuch_negative_warrior
						format = "FF_VALUE_FORMAT"
					}
				}
			}
			else = {
				add = {
					value = -150
					desc = BMU_tooltip_feudal_elector_vote_eunuch_negative_byzantine
					format = "FF_VALUE_FORMAT"
				}
			}
		}
		if = {
			limit = { scope:s_contender = { has_trait = giant }}
			#Praised for being Berserker
			if = {
				limit = { scope:supporter = { this_is_martial_society_trigger = yes }}
				add = {
					value = 10
					desc = BMU_tooltip_feudal_elector_vote_giant_positive
					format = "FF_VALUE_FORMAT"
				}
			}
			#Shunned for being Berserker
			else = {
				add = {
					value = -10
					desc = BMU_tooltip_feudal_elector_vote_giant_negative
					format = "FF_VALUE_FORMAT"
				}
			}
		}
	}
}

FF_elector_voting_pattern_opinion_feudal_elective_modifier = {
	#Raw Opinion bonus (negative)
	if = {
		limit = {
			NOT = { this = scope:supporter }
			scope:supporter = {
				save_temporary_opinion_value_as = {
					name = opinion_of_contender
					target = scope:s_contender
				}
			}
		}
		if = {
			limit = { scope:opinion_of_contender < 0 }
			add = {
				value = {
					scope:supporter = {
						add = scope:opinion_of_contender
						if = {
							limit = { has_relation_rival = scope:s_contender }
							subtract = 50
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_opinion_negative
				format = "FF_VALUE_FORMAT"
			}
		}
		else = {
			add = {
				value = {
					scope:supporter = {
						add = scope:opinion_of_contender
						if = {
							limit = {
								OR = {
									has_relation_rival = scope:s_contender
									has_relation_lover = scope:s_contender
								}
							}
							subtract = 50
						}
					}
				}
				desc = BMU_tooltip_feudal_elector_vote_opinion_positive
				format = "FF_VALUE_FORMAT"
			}
		}
	}
}

FF_elective_logic = {
	add = FF_elector_self_voting_pattern_feudal_elective_modifier
	add = FF_elector_voting_pattern_circumstances_feudal_elective_modifier
	add = FF_elector_voting_pattern_prestige_piety_feudal_elective_modifier
	add = FF_elector_voting_pattern_opinion_feudal_elective_modifier
}

# references prev
# needs to be used chained to a scope

BMU_candidate_score = { add = BMU_contender_score }

BMU_contender_score = {
	if = {
		limit = {
			exists = scope:story
			scope:story = { story_type = BMU_pressed_claim_story }
		}
		if = {
			limit = {
				NOT = { exists = scope:claim_target }
				scope:story.story_owner = { save_temporary_scope_as = claim_target }
			}
		}
		if = {
			limit = {
				NOT = { exists = scope:claimed_title }
				scope:story.var:claimed_title = { save_temporary_scope_as = claimed_title }
			}
		}
		if = {
			limit = {
				exists = prev NOT = { this = prev }
				prev = { save_temporary_scope_as = s_supporter }
				save_temporary_scope_as = s_contender
				if = { limit = { NOT = { exists = scope:contender } save_temporary_scope_as = contender }}
			}
			prev = {
				add = FF_elective_logic
				add = BMU_involvement_score
			}
		}
	}
}

BMU_involvement_score = {
	if = {
		limit = {
			is_independent_ruler = no
			liege = scope:contender
			FF_loyalty > 0
		}
		add = {
			value = FF_loyalty
			desc = FF_loyalty
			format = "FF_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			any_owned_story = {
				story_type = BMU_stakeholder_story
				var:pressed_claim_story.var:claimed_title = scope:claimed_title
				var:pressed_claim_story.var:claim_target = scope:claim_target
				has_variable = claimant_faction
				var:faction_claimant = scope:contender
			}
		}
		add = {
			value = {
				add = 100
				add = ai_honor
			}
			desc = BMU_tooltip_faction_claimant
			format = "FF_VALUE_FORMAT"
		}
	}
	if = {
		limit = { is_allied_to = scope:contender }
		add = {
			value = {
				add = 100
				add = ai_honor
				if = {
					limit = { scope:contender = scope:story.var:claim_target }
					multiply = 2
				}
			}
			desc = BMU_tooltip_ally
			format = "FF_VALUE_FORMAT"
		}
	}
	if = {
		limit = { ai_boldness < 0 }
		add = {
			value = ai_boldness
			desc = BMU_tooltip_reluctance_to_fight
			format = "FF_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			any_owned_story = {
				story_type = BMU_stakeholder_story
				var:pressed_claim_story = scope:story
				has_variable = status
				var:status = flag:stakeholder
			}
			ai_greed > 0	
		}
		add = {
			value = {
				subtract = ai_greed
			}
			desc = BMU_tooltip_unfulfilled_ambitions
			format = "FF_VALUE_FORMAT"
		}
	}
	# ordered_owned_story = {
	# 	limit = {
	# 		story_type = BMU_stakeholder_story
	# 		var:pressed_claim_story.var:claimed_title = scope:claimed_title
	# 		var:pressed_claim_story.var:claim_target = scope:claim_target
	# 	}
	# 	var:pressed_claim_story.var:top_contender = { save_temporary_scope_as = top_contender }
	# 	add = {
	# 		value = {
	# 			subtract = { scope:top_contender = { add = BMU_contender_score }}
	# 		}
	# 		desc = BMU_tooltip_top_contender_score
	# 		format = "FF_VALUE_TOOLTIP"
	# 	}
	# }
}

gui_BMU_candidate_score = { add = gui_BMU_contender_score }
gui_BMU_contender_score = {
	if = {
		limit = {
			exists = scope:story
			scope:story = { story_type = BMU_pressed_claim_story }
		}
		if = {
			limit = {
				NOT = { exists = scope:claim_target }
				scope:story.story_owner = { save_temporary_scope_as = claim_target }
			}
		}
		if = {
			limit = {
				NOT = { exists = scope:claimed_title }
				scope:story.var:claimed_title = { save_temporary_scope_as = claimed_title }
			}
		}
		if = {
			limit = {
				exists = scope:gui_contender
				scope:gui_contender = { save_temporary_scope_as = s_contender }
			}
		}
		add = FF_elective_logic
		add = BMU_involvement_score
	}
}

#Requires 
# BMU_supporter_score = {
# 	add = scope:contender.BMU_contender_score
# 	if = {
# 		limit = {
# 			is_independent_ruler = no
# 			is_landed = yes
# 			liege = scope:contender
# 		}
# 		add = {
# 			value = {
# 				add = FF_loyalty
# 				if = {
# 					limit = { ai_greed > 0 }
# 					subtract = ai_greed
# 					if = {
# 						limit = { exists = scope:top_contender }
# 						subtract = {
# 							add = scope:top_contender.BMU_contender_score
# 							subtract = scope:contender.BMU_contender_score
# 							min = 0
# 						}
# 					}
# 					else = {
# 						random_owned_story = {
# 							limit = {
# 								story_type = BMU_stakeholder_story
# 								var:pressed_claim_story.var:claimed_title = scope:claimed_title
# 								has_variable = status
# 								var:status = flag:supporter
# 							}
# 							add = {

# 							}
# 						}
# 					}
# 				}
# 			}
# 		}
# 	}
# }

# gui_picked_contender_score = {
# 	if = {
# 		limit = {
# 			any_in_global_list = {
# 				variable = BMU_claim_stories
# 				is_target_in_variable_list = {
# 					name = stakeholders
# 					target = root
# 				}
# 				save_temporary_scope_as = story
# 				any_in_list = {
# 					variable = supporter_stories
# 					story_owner = root
# 					exists = var:tooltip_contender
# 					var:tooltip_contender = {
# 						save_temporary_scope_as = contender
# 					}
# 				}
# 			}
# 		}
# 	}

# }

top_contender_score = {
	if = {
		limit = {
			any_owned_story = {
				story_type = BMU_stakeholder_story
				has_variable = status
				var:status = flag:supporter
				exists = var:top_contender
				var:top_contender = { save_temporary_scope_as = contender }
				exists = var:claim_story
				var:pressed_claim_story = { save_temporary_scope_as = story }
			}
		}
		add = BMU_contender_score
	}
}


test = {
	add = age
	prev = { add = age }
}